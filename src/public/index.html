<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ Thống Trắc Nghiệm Cloudflare</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: sans-serif; }
        body { background: #f0f2f5; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; width: 100%; max-width: 600px; padding: 25px; border-radius: 15px; shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header { margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .option { padding: 15px; margin: 10px 0; border: 2px solid #f0f0f0; border-radius: 10px; cursor: pointer; transition: 0.2s; }
        .option:hover { background: #f8f9fa; border-color: #007bff; }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724; font-weight: bold; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }
        .disabled { pointer-events: none; }
        #next-btn { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; display: none; font-size: 16px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h3 id="progress">Đang tải câu hỏi...</h3>
            <p>Đúng: <span id="score">0</span></p>
        </div>
        <div id="quiz-content">
            <h2 id="question-text" style="margin-bottom: 20px;"></h2>
            <div id="options-container"></div>
        </div>
        <button id="next-btn" onclick="handleNext()">Câu tiếp theo ➜</button>
    </div>

    <script>
        let quizData = [];
        let currentIdx = 0;
        let score = 0;

        // Hàm nạp dữ liệu từ file JSON cùng thư mục
        async function initQuiz() {
            try {
                const res = await fetch('questions.json');
                const data = await res.json();
                quizData = data.sort(() => Math.random() - 0.5); // Xáo trộn 120 câu
                renderQuestion();
            } catch (e) {
                document.getElementById('question-text').innerText = "Lỗi nạp câu hỏi!";
            }
        }

        function renderQuestion() {
            const q = quizData[currentIdx];
            document.getElementById('progress').innerText = `Câu ${currentIdx + 1}/${quizData.length}`;
            document.getElementById('question-text').innerText = q.q;
            
            const container = document.getElementById('options-container');
            container.innerHTML = '';

            q.a.forEach((txt, i) => {
                const div = document.createElement('div');
                div.className = 'option';
                div.innerText = txt;
                div.onclick = () => checkAnswer(div, i, q.c);
                container.appendChild(div);
            });
            document.getElementById('next-btn').style.display = 'none';
        }

        function checkAnswer(el, selected, correct) {
            const opts = document.querySelectorAll('.option');
            opts.forEach(o => o.classList.add('disabled'));

            if(selected === correct) {
                el.classList.add('correct');
                score++;
                document.getElementById('score').innerText = score;
            } else {
                el.classList.add('wrong');
                opts[correct].classList.add('correct');
            }
            document.getElementById('next-btn').style.display = 'block';
        }

        function handleNext() {
            currentIdx++;
            if(currentIdx < quizData.length) renderQuestion();
            else alert("Bạn đã hoàn thành bài thi! Điểm: " + score);
        }

        initQuiz();
    </script>
</body>
</html>
